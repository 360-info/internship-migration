---
title: "analysis-missing_migrants"
author: "Ruimin Lin - 28757599"
code-fold: true
theme: style/article.scss
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(themes360info)
library(leaflet)
```

- The missing migrants data is obtained from [Missing Migrants Project](https://missingmigrants.iom.int/).

```{r}
missingMG <- read_csv("data/Missing_Migrants_Global_Figures_allData.csv")
missingMG
```


```{r}
missingMG <- missingMG %>%
  mutate_at(vars(8:14),
            funs(ifelse(is.na(.),0,.)))
missingMG

# Converting NA values to 0, from columns `Number of Dead` to `Number of Children`. 
```

```{r}

missingMG$Coordinates <- 
  str_extract_all(missingMG$Coordinates, "(?<=\\().+?(?=\\))") %>%
  str_split(" ", 2)


missingMG <- missingMG %>%
  drop_na(Coordinates) %>%
  mutate(Coordinates = sapply(Coordinates, toString)) %>%
  separate(Coordinates,
           c("lon", "lat"),
           ",")

missingMG <- missingMG %>%
  drop_na(lon, lat) %>%
  mutate(lon = as.double(lon),
         lat = as.double(lat),
         `Incident year` = as.character(`Incident year`))

missingMGrecent <- 
  missingMG %>%
  filter(`Incident year` == 2020)
```


```{r}
leaflet(missingMGrecent) %>%
  addProviderTiles("Esri") %>%
  addMarkers(lng = ~lon,
             lat = ~lat) 

#shapefile from http://thematicmapping.org/downloads/world_borders.php
```


#### cause of death

```{r}
missingMG1 <- missingMG %>%
  select(`Incident year`,
         `Region of Incident`,
         `Total Number of Dead and Missing`) %>%
  group_by(`Incident year`, `Region of Incident`) %>%
  summarise(n())
  
```

```{r}
missingMG1 %>%
  ggplot(aes(x = `Incident year`,
             y = `Region of Incident`,
             fill = `n()`)) +
  geom_tile() +
  geom_text(aes(label = `n()`)) +
  scale_fill_gradient(low = "white", high = "red") +
  theme_minimal()

```


```{r}
missingMG %>%
  ggplot(aes(x = `Reported Month`,
             y = `Total Number of Dead and Missing`)) +
  geom_col(aes(fill = `Region of Incident`))
```


